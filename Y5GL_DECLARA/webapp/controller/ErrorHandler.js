sap.ui.define(["sap/ui/base/Object","sap/m/MessageBox"],function(e,r){"use strict";return e.extend("Y5GL_DECLARACOES.Y5GL_DECLARACOES.controller.ErrorHandler",{constructor:function(e){this._oResourceBundle=e.getModel("i18n").getResourceBundle();this._oComponent=e;this._oModel=e.getModel();this._bMessageOpen=false;this._sErrorText=this._oResourceBundle.getText("errorText");this._oModel.attachMetadataFailed(function(e){var r=e.getParameters();this._showServiceError(r.response)},this);this._oModel.attachRequestFailed(function(e){var r=e.getParameters();if(r.response.statusCode!=="404"||r.response.statusCode===404&&r.response.responseText.indexOf("Cannot POST")===0){this._showServiceError(r.response)}},this)},_extractError:function(e){if(e.responseText){var r=null;try{r=jQuery.sap.parseJS(e.responseText)}catch(r){return e}if(r&&r.error&&r.error.code){var s="";if(r.error.code.split("/")[0]==="MY_MSG_CLASS"){var t=r.error.innererror.errordetails;for(var o=0;o<t.length;o++){s+=String.fromCharCode("8226")+" "+t[o].message+"\n"}}else{return e}return s}}return e},_showServiceError:function(e){if(this._bMessageOpen){return}this._bMessageOpen=true;r.error(this._sErrorText,{id:"serviceErrorMessageBox",details:this._extractError(e),styleClass:this._oComponent.getContentDensityClass(),actions:[r.Action.CLOSE],onClose:function(){this._bMessageOpen=false}.bind(this)})}})});