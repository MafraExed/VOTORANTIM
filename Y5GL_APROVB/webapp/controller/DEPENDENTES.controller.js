sap.ui.define(["Y5GL_APROVB/Y5GL_APROVB/controller/BaseController","sap/ui/Device","sap/m/Dialog","sap/m/Button"],function(e,t,r,s){"use strict";return e.extend("Y5GL_APROVB.Y5GL_APROVB.controller.DEPENDENTES",{onInit:function(){this.getRouter().getRoute("DEPENDENTES").attachPatternMatched(this.onRefreshList,this)},onRefreshList:function(){var e=this.getView().byId("list");var t=e.getBinding("items");t.refresh(true)},onSelectionChange:function(e){var t=e.getSource(),r=e.getParameter("selected");if(!(t.getMode()==="MultiSelect"&&!r)){this._showDetail(e.getParameter("listItem")||e.getSource())}},_showDetail:function(e){var r=!t.system.phone;var s="DepententeDetail";var o=e.getBindingContext().getProperty("Pernr");var a=e.getBindingContext().getProperty("Subty");var i="A";var n=e.getBindingContext().getProperty("Objps");var d=e.getBindingContext().getProperty("Favor");this.getRouter().navTo(s,{Pernr:o,Subty:a,Objps:n,Tipo:i,Favor:d},r)},addDependentes:function(e){var t="0";var r="A";var s="-";var o="-";var a="-";var i="DependentesAdd";this.getRouter().navTo(i,{Pernr:t,Subty:o,Objps:s,Tipo:r,Favor:a})},onSave:function(){var e=this.getOwnerComponent();var t=e.oListSelector._oList;var o=t.getBinding("items");var a=this.getView().getModel();var i=this.getView().byId("IdPernr").getValue();var n=this.getView().byId("IdParentesco").getSelectedKey();var d=this.getView().byId("IdObjps").getValue();d="-";var g="/ZET_GLRH_LIST_DEPENDENTESSet(Pernr='"+i+"',Subty='"+n+"',Objps='"+d+"',Tipo='S')";var c={};c.Parentesco=this.getView().byId("IdParentesco").getSelectedKey();if(c.Parentesco===""){this.getView().byId("IdParentesco").setValueState("Error");sap.m.MessageBox.error("Selecione o Grau de Parentesco.");return}else{this.getView().byId("IdParentesco").setValueState("Success")}c.Favor=this.getView().byId("IdFavor").getValue();if(c.Favor===""){this.getView().byId("IdFavor").setValueState("Error");sap.m.MessageBox.error("Preencher o Nome.");return}else{this.getView().byId("IdFavor").setValueState("Success")}c.Fanam=this.getView().byId("IdFanam").getValue();if(c.Fanam===""){this.getView().byId("IdFanam").setValueState("Error");sap.m.MessageBox.error("Preencher o sobrenome.");return}else{this.getView().byId("IdFanam").setValueState("Success")}c.Fgbdt=this.getView().byId("IdFgbdt").getValue();if(c.Fgbdt===""){this.getView().byId("IdFgbdt").setValueState("Error");sap.m.MessageBox.error("Selecione data de nascimento.");return}else{this.getView().byId("IdFgbdt").setValueState("Success")}c.Sexo=this.getView().byId("IdSexo").getSelectedKey();if(c.Sexo===" "){this.getView().byId("IdSexo").setValueState("Error");sap.m.MessageBox.error("Selecione o sexo.");return}else{this.getView().byId("IdSexo").setValueState("Success")}c.Zzestciv=this.getView().byId("IdZzestciv").getSelectedKey();if(c.Zzestciv===" "){this.getView().byId("IdZzestciv").setValueState("Error");sap.m.MessageBox.error("Selecione o Estado Civil.");return}else{this.getView().byId("IdZzestciv").setValueState("Success")}var u=" ";var l=u;if(l===""){sap.m.MessageBox.error("Anexo é obrigatório");return}var v=new r({title:"Confirmação",type:"Message",content:new Text({text:"Confirma o envio do novo dependente para aprovação?"}),beginButton:new s({text:"Sim",press:function(){a.update(g,c,{success:function(e,t){sap.m.MessageBox.success("Dependente enviado para aprovação com sucesso. Favor aguardar aprovação CSC.",{actions:["OK",sap.m.MessageBox.Action.CLOSE],onClose:function(e){v.close()}})},error:function(e){sap.m.MessageBox.error("Erro ao chamar o serviço")}});v.close()}}),endButton:new s({text:"Não",press:function(){v.close()}}),afterClose:function(){v.destroy();o.refresh(true);this.getModel("appView").setProperty("/layout","MidColumnFullScreen");this.getRouter().navTo("master")}});v.open();this.getRouter().navTo("master")},onBackMaster:function(){this.getRouter().navTo("master")}})});