sap.ui.define(["Y5GL_APROVB/Y5GL_APROVB/controller/BaseController","sap/ui/Device","Y5GL_APROVB/Y5GL_APROVB/model/formatter","sap/m/Button","sap/m/Dialog","sap/m/Text","sap/ui/model/json/JSONModel"],function(e,t,a,i,s,r,d){"use strict";var o;var n;var l;var g;var u;var I;return e.extend("Y5GL_APROVB.Y5GL_APROVB.controller.DepententeDetail",{formatter:a,onInit:function(){this.getRouter().getRoute("DepententeDetail").attachPatternMatched(this._onObjectMatched,this);this.getRouter().getRoute("DependentesAdd").attachPatternMatched(this._onAdd,this)},onVoltar:function(){var e=!t.system.phone;var a="DEPENDENTES";this.getRouter().navTo(a,e)},_onAdd:function(e){var t=e.getParameter("arguments").Pernr;var a=e.getParameter("arguments").Subty;var i=e.getParameter("arguments").Tipo;var s=e.getParameter("arguments").Objps;var r=e.getParameter("arguments").Favor;var d;this.getView().byId("IdParentesco").setEditable(true);this.getView().byId("IdFavor").setEditable(true);this.getView().byId("IdFanam").setEditable(true);this.getView().byId("IdFgbdt").setEditable(true);this.getView().byId("IdSexo").setEditable(true);this.getView().byId("IdZzestciv").setEditable(true);this.getView().byId("IdSalvarDetailDep").setVisible(true);this.getView().byId("IdEditDetailDep").setVisible(false);this.getView().byId("IdCancelarDetailDep").setVisible(false);this.getView().byId("IdExcluirDetailDep").setVisible(false);this.getView().byId("IdParentesco").setValueState("None");this.getView().byId("IdFavor").setValueState("None");this.getView().byId("IdFanam").setValueState("None");this.getView().byId("IdFgbdt").setValueState("None");this.getView().byId("IdFgbdt").setValueState("None");this.getView().byId("IdSexo").setValueState("None");this.getView().byId("IdZzestciv").setValueState("None");this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getModel().metadataLoaded().then(function(){d=this.getModel().createKey("ZET_GLRH_DEPENDENTESSet",{Pernr:t,Subty:a,Objps:s,Tipo:i,Favor:r});this._bindView("/"+d)}.bind(this))},onEdit:function(){o=this.getView().byId("IdParentesco").getSelectedKey();n=this.getView().byId("IdFavor").getValue();l=this.getView().byId("IdFanam").getValue();g=this.getView().byId("IdFgbdt").getValue();u=this.getView().byId("IdSexo").getValue();I=this.getView().byId("IdZzestciv").getSelectedKey();this.getView().byId("IdEditDetailDep").setVisible(false);this.getView().byId("IdSalvarDetailDep").setVisible(true);this.getView().byId("IdCancelarDetailDep").setVisible(true);this.getView().byId("IdParentesco").setEditable(true);this.getView().byId("IdFavor").setEditable(true);this.getView().byId("IdFanam").setEditable(true);this.getView().byId("IdFgbdt").setEditable(true);this.getView().byId("IdSexo").setEditable(true);this.getView().byId("IdZzestciv").setEditable(true)},onCancel:function(){this.getView().byId("IdCancelarDetailDep").setVisible(false);this.getView().byId("IdEditDetailDep").setVisible(true);this.getView().byId("IdSalvarDetailDep").setVisible(false);this.getView().byId("IdParentesco").setEditable(false);this.getView().byId("IdFavor").setEditable(false);this.getView().byId("IdFanam").setEditable(false);this.getView().byId("IdFgbdt").setEditable(false);this.getView().byId("IdSexo").setEditable(false);this.getView().byId("IdZzestciv").setEditable(false);this.getView().byId("IdParentesco").setSelectedKey(o);this.getView().byId("IdFavor").setValue(n);this.getView().byId("IdFanam").setValue(l);this.getView().byId("IdFgbdt").setValue(g);this.getView().byId("IdSexo").setValue(u);this.getView().byId("IdZzestciv").setSelectedKey(I)},onchangeParentesco:function(){},_onObjectMatched:function(e){var t=e.getParameter("arguments").Pernr;var a=e.getParameter("arguments").Subty;var i=e.getParameter("arguments").Tipo;var s=e.getParameter("arguments").Objps;var r=e.getParameter("arguments").Favor;this.getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");this.getModel().metadataLoaded().then(function(){var e=this.getModel().createKey("ZET_GLRH_DEPENDENTESSet",{Pernr:t,Subty:a,Objps:s,Tipo:i,Favor:r});this._bindView("/"+e)}.bind(this));this.getView().byId("IdParentesco").setEditable(false);this.getView().byId("IdFavor").setEditable(false);this.getView().byId("IdFanam").setEditable(false);this.getView().byId("IdFgbdt").setEditable(false);this.getView().byId("IdSexo").setEditable(false);this.getView().byId("IdZzestciv").setEditable(false);this.getView().byId("IdSalvarDetailDep").setVisible(false);this.getView().byId("IdCancelarDetailDep").setVisible(false);this.getView().byId("IdExcluirDetailDep").setVisible(true)},_bindView:function(e){var t=this.getView().getModel();t.setProperty("/busy",false);this.getView().bindElement({path:e,events:{change:this._onBindingChange.bind(this),dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(){t.setProperty("/busy",false)}}})},_onBindingChange:function(){var e=this.getView(),t=e.getElementBinding();if(!t.getBoundContext()){this.getRouter().getTargets().display("detailObjectNotFound");this.getOwnerComponent().oListSelector.clearMasterListSelection();return}},onExcluir:function(){var e=this;var t=this.getView().getModel();var a=this.getView().byId("IdPernr").getValue();var d=this.getView().byId("IdParentesco").getSelectedKey();var o=this.getView().byId("IdObjps").getValue();var n=this.getView().byId("IdFavor").getValue();var l="/ZET_GLRH_DEPENDENTESSet(Pernr='"+a+"',Subty='"+d+"',Objps='"+o+"',Favor='"+n+"',Tipo='E')";var g={};g.Tipo="E";var u=new s({title:"Confirmação",type:"Message",content:new r({text:"Confirma a exclusão ?"}),beginButton:new i({text:"Sim",press:function(){t.update(l,g,{success:function(t,a){sap.m.MessageBox.success("Dependente excluido com sucesso.",{actions:["OK",sap.m.MessageBox.Action.CLOSE],onClose:function(t){e.getRouter().navTo("DEPENDENTES")}})},error:function(e){sap.m.MessageBox.error("Erro ao chamar o serviço")}});u.close()}}),endButton:new i({text:"Não",press:function(){u.close()}}),afterClose:function(){u.destroy()}});u.open()},onChange:function(e){var t=e.getSource();var a=this.getView().getModel().oHeaders["x-csrf-token"];var i=new sap.m.UploadCollectionParameter({name:"x-csrf-token",value:a});t.addHeaderParameter(i)},onBeforeUploadStarts:function(e){var t=this.getView().byId("IdPernr").getValue();var a=this.getView().byId("IdSubty").getValue();var i=this.getView().byId("IdObjps").getValue();var s=this.getView().byId("IdFavor").getValue();var r=t+"$"+a+"$"+i+"$"+s+"$"+e.getParameter("fileName");var d=new sap.m.UploadCollectionParameter({name:"slug",value:r});e.getParameters().addHeaderParameter(d)},onuploadComplete:function(e){var t=this.getView().byId("IdPernr").getValue();var a=this.getView().byId("IdSubty").getValue();var i=this.getView().byId("IdFavor").getValue();var s=new sap.ui.model.Filter("Pernr",sap.ui.model.FilterOperator.EQ,t);var r=new sap.ui.model.Filter("Subty",sap.ui.model.FilterOperator.EQ,a);var d=new sap.ui.model.Filter("Favor",sap.ui.model.FilterOperator.EQ,i);var o=this.getView().byId("UploadCollection");o.getBindingInfo("items").filter([s,r,d])},onmodelContextChange:function(e){var t=this.getView().byId("IdPernr").getValue();var a=this.getView().byId("IdSubty").getValue();var i=this.getView().byId("IdFavor").getValue();var s=new sap.ui.model.Filter("Pernr",sap.ui.model.FilterOperator.EQ,t);var r=new sap.ui.model.Filter("Subty",sap.ui.model.FilterOperator.EQ,a);var d=new sap.ui.model.Filter("Favor",sap.ui.model.FilterOperator.EQ,i);e.getSource().getBinding("items").filter([s,r,d])},onSave:function(){var e=this;var t=this.getView().getModel();var a=this.getView().byId("IdPernr").getValue();var d=this.getView().byId("IdParentesco").getSelectedKey();var o=this.getView().byId("IdObjps").getValue();var n=this.getView().byId("IdFavor").getValue();var l="/ZET_GLRH_DEPENDENTESSet(Pernr='"+a+"',Subty='"+d+"',Objps='"+o+"',Favor='"+n+"',Tipo='S')";var g={};g.Parentesco=this.getView().byId("IdParentesco").getSelectedKey();if(g.Parentesco===""){this.getView().byId("IdParentesco").setValueState("Error");sap.m.MessageBox.error("Selecione o Grau de Parentesco.");return}else{this.getView().byId("IdParentesco").setValueState("Success")}g.Favor=this.getView().byId("IdFavor").getValue();if(g.Favor===""){this.getView().byId("IdFavor").setValueState("Error");sap.m.MessageBox.error("Preencher o Nome.");return}else{this.getView().byId("IdFavor").setValueState("Success")}g.Fanam=this.getView().byId("IdFanam").getValue();if(g.Fanam===""){this.getView().byId("IdFanam").setValueState("Error");sap.m.MessageBox.error("Preencher o sobrenome.");return}else{this.getView().byId("IdFanam").setValueState("Success")}g.Fgbdt=this.getView().byId("IdFgbdt").getValue();if(g.Fgbdt===""){this.getView().byId("IdFgbdt").setValueState("Error");sap.m.MessageBox.error("Selecione data de nascimento.");return}else{this.getView().byId("IdFgbdt").setValueState("Success")}g.Sexo=this.getView().byId("IdSexo").getSelectedKey();if(g.Sexo===" "){this.getView().byId("IdSexo").setValueState("Error");sap.m.MessageBox.error("Selecione o sexo.");return}else{this.getView().byId("IdSexo").setValueState("Success")}g.Zzestciv=this.getView().byId("IdZzestciv").getSelectedKey();if(g.Zzestciv===" "){this.getView().byId("IdZzestciv").setValueState("Error");sap.m.MessageBox.error("Selecione o Estado Civil.");return}else{this.getView().byId("IdZzestciv").setValueState("Success")}var u=" ";var I=u;if(I===""){sap.m.MessageBox.error("Anexo é obrigatório");return}var b=new s({title:"Confirmação",type:"Message",content:new r({text:"Confirma a inclusão do dependente?"}),beginButton:new i({text:"Sim",press:function(){t.update(l,g,{success:function(t,a){sap.m.MessageBox.success("Dependente salvo com sucesso.",{actions:["OK",sap.m.MessageBox.Action.CLOSE],onClose:function(t){e.getRouter().navTo("DEPENDENTES")}})},error:function(e){sap.m.MessageBox.error("Erro ao chamar o serviço")}});b.close()}}),endButton:new i({text:"Não",press:function(){b.close()}}),afterClose:function(){b.destroy()}});b.open()},onBackMaster:function(){this.getRouter().navTo("master")}})});