"use strict";
/*!
 * SiGC - GestiÃ³n de Compras
 * (c) Copyright 2022 Innova Internacional S.A.S.
 */sap.ui.define(["com/innova/sigc/model/constant","com/innova/sigc/service/http","sap/base/util/deepExtend","sap/m/MessageBox"],function(e,t,a,r){return{onAddNewCategoryRecord:function e(){this.getView().getModel("Settings").setProperty("/IsCreateCategory",true);this.bUpdateCategory=false;this.getView().getModel("Settings").setProperty("/createcategory",{category:"",description:"",language:this.getModel("main").getProperty("/currentLanguage")});this.handleOpenCategoryDialog()},onCategoryEditPress:function e(){var t=this.getView().getModel("Settings").getProperty("/selectedTableRow");if(t.length===0){r.error(this.getResourceBundle().getText("Commons.0022"));return}var o=a({},t[0]);this.getView().getModel("Settings").setProperty("/IsCreateCategory",false);this.getView().getModel("Settings").refresh(true);this.bUpdateCategory=true;this.getView().getModel("Settings").setProperty("/createcategory",o);this.handleOpenCategoryDialog(o)},onCategoryDeletePress:function t(){var a=this.getView().getModel("Settings").getProperty("/selectedTableRow");if(a.length===0){r.error(this.getResourceBundle().getText("Commons.0022"));return}var o=a[0];this._openDeleteRecordDialog(o.id,e.api.PROCESS_CATEGORY_PATH)},onCreateorUpdateCategoryPress:function t(){var o=this;var i=a({},this.getView().getModel("Settings").getProperty("/createcategory"));var n=this;var s=n.getView().getModel("main").getProperty("/sysParams/UNAME");var g="";if(!this.bUpdateCategory){g={createdBy:s}}else{g={processCat:{id:i.id},language:i.language,description:i.description}}if(this.bUpdateCategory){this.handleSaveorUpdate(g,i.id,"".concat(e.api.CAT_DESC,"/").concat(i.id)).then(function(e){if(e.statusText==="OK"){n.getCategories();r.success(o.getResourceBundle().getText("0232"))}}).catch(function(e){r.error(e.message)})}else{this.handleSaveorUpdate(g,"",e.api.PROCESS_CATEGORY_PATH).then(function(t){i=n.getView().getModel("Settings").getProperty("/createcategory");var a={processCat:{id:t.data.id},language:o.getModel("main").getProperty("/currentLanguage"),description:i.description};n.handleSaveorUpdate(a,"",e.api.CAT_DESC).then(function(e){if(e.statusText==="Created"){n.getCategories();r.success(o.getResourceBundle().getText("0233"))}}).catch(function(e){r.error(e.message)})})}this.onCategoryClosePress()},handleOpenCategoryDialog:function e(t){var a=this;if(!this._oCreateNewCategoryData){this._oCreateNewCategoryData=sap.ui.core.Fragment.load({id:this.getView().getId(),name:"com.innova.sigc.view.settings.fragment.CreateCategory",controller:this}).then(function(e){var r=e;a.getView().addDependent(r);r.addStyleClass(a.getOwnerComponent().getContentDensityClass());r.setModel(a.getView().getModel("Settings"),"Settings");if(!t){r.getModel("Settings").setProperty("/createcategory",{category:"",description:"",language:a.getModel("main").getProperty("/currentLanguage")})}r.setModel(a.getView().getModel("i18n"),"i18n");return r})}this._oCreateNewCategoryData.then(function(e){e.open()})},onCategoryClosePress:function e(){this._oCreateNewCategoryData.then(function(e){e.close()})},getCategories:function a(){var r=this.getModel("main").getProperty("/currentLanguage");return t.get("".concat(e.api.PROCESS_CATEGORY_PATH,"?language=").concat(r)).then(this._handleResponseData.bind(this))}}});