"use strict";
/*!
 * SiGC - GestiÃ³n de Compras
 * (c) Copyright 2022 Innova Internacional S.A.S.
 */sap.ui.define(["com/innova/sigc/model/constant","com/innova/sigc/service/petitions","sap/base/util/deepExtend","sap/m/MessageBox"],function(e,t,i,r){return{onAddNewPriorities:function e(){this.getView().getModel("Settings").setProperty("/IsCreatePriorities",true);this.bUpdatePriority=false;this.handleOpenPriorityDialog()},handleOpenPriorityDialog:function e(t){var i=this;this._oPrioritiesDialog=sap.ui.core.Fragment.load({id:this.getView().getId(),name:"com.innova.sigc.view.settings.fragment.CreatePriority",controller:this}).then(function(e){var r=e;i.getView().addDependent(r);r.addStyleClass(i.getOwnerComponent().getContentDensityClass());r.attachAfterClose(r.destroy.bind(r));if(!t){i.getModel("Settings").setProperty("/createpriority",{PRIORIDAD:"",ERNAM:"",KNTTP:"",PSTYP:"",EKORG:"",CONTRACT:"",LAST_BUYER:"",BUYER:""})}return r});this._oPrioritiesDialog.then(function(e){e.open()})},onCreateorUpdatePriorityPress:function e(){var t=i({},this.getView().getModel("Settings").getProperty("/createpriority"));if(this.bUpdatePriority){t.CRUD="U";this._saveOrUpdatePriorities(t)}else{t.CRUD="C";this._saveOrUpdatePriorities(t)}},onPriorityCancelPress:function e(){return this._oPrioritiesDialog.then(function(e){e.close()})},onPriorityDeletePress:function e(){var t=this.getView().getModel("Settings").getProperty("/selectedTableRow");if(t.length===0){r.error(this.getResourceBundle().getText("Commons.0022"));return}var i=t[0];i.CRUD="D";this._openDeleteRecordDialog("","",true,i)},onPriorityEditPress:function e(){var t=this.getView().getModel("Settings").getProperty("/selectedTableRow");if(t.length===0){r.error(this.getResourceBundle().getText("Commons.0022"));return}var o=t[0];this.getView().getModel("Settings").setProperty("/IsCreatePriorities",false);this.bUpdatePriority=true;this.getView().getModel("Settings").setProperty("/createpriority",i({},o));this.handleOpenPriorityDialog(o)},_saveOrUpdatePriorities:function i(r){t.post(e.GET_CONF_PRIORITY,{IT_PRIOR:[r]}).then(this.getPriorities.bind(this)).then(this.onPriorityCancelPress.bind(this)).catch(this.errorHandler.bind(this))},getPriorities:function i(){var r=this.getView().getModel("Settings");return t.post(e.GET_CONF_PRIORITY,{IT_PRIOR:[{CRUD:"R"}]}).then(function(e){var t=e.data;return r.setProperty("/priorities",t)}).then(t.post.bind(t,e.GET_BUYERS)).then(function(e){var t=e.data;r.setProperty("/buyers",t)})}}});