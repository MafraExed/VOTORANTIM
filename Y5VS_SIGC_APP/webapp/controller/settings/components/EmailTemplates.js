"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}
/*!
 * SiGC - GestiÃ³n de Compras
 * (c) Copyright 2022 Innova Internacional S.A.S.
 */sap.ui.define(["com/innova/sigc/lib/richTextEditor/editor","com/innova/sigc/model/constant","com/innova/sigc/service/http","com/innova/sigc/utils/showToast","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,t,n,i,o,r){return{onHelpIconPress:function e(t){var n=this;var i=t.getSource();if(!this._pPopover){this._pPopover=o.load({id:this._oView.getId(),name:"com.innova.sigc.view.settings.fragment.TemplateHelp",controller:this}).then(function(e){n._oView.addDependent(e);return e})}this._pPopover.then(function(e){if(e.openBy){e.openBy(i)}else{e.open()}})},onCloseTemplateHelpPress:function e(){this._pPopover.then(function(e){e.close()})},onSavePress:function e(){var o=this;var r=this.getModel("emailTemplate");var a=r.getData();if(a){Promise.resolve(this._oPage.setBusy(true)).then(n.update.bind(n,"".concat(t.api.CUSTOM_TEMPLATE),{type:a.type,subject:a.subject,content:this._oEmailTemplateEditor.getContent()})).then(function(){return i(o.getResourceBundle().getText("0387"))}).catch(this.errorHandler.bind(this)).finally(this._oPage.setBusy.bind(this._oPage,false))}},_getEmailTemplates:function e(i){var o;var r=i.templateName;this._oView.byId("sHelpIconId").setVisible(true);(o=this._oEmailTemplateEditor)===null||o===void 0?void 0:o.setContent("");return n.get("".concat(t.api.CUSTOM_TEMPLATE,"/").concat(r)).then(this._handleEmailTemplateData.bind(this)).then(this._renderEmailTemplateEditor.bind(this))},_handleEmailTemplateData:function e(t){var n=t.data;var i={offer_vendor_invitation:"0409",process_adendo_created:"0423",process_invitation:"0424",process_qa_answer:"0425",process_qa_question:"0426",registration_welcome_user:"0427",registration_welcome_vendor:"0428",user_registration:"0429",vendor_registration:"0430"};this.setModel(new r(_objectSpread(_objectSpread({},n),{},{title:this.getResourceBundle().getText(i[n.type])})),"emailTemplate")},_renderEmailTemplateEditor:function t(){var n=this;return new Promise(function(t){if(!n._oEmailTemplateEditor){e.removeEditorManager();n._oEmailTemplateEditor=e.initializeQuillEditor.call(n,{container:n.getView().byId("emailTemplateEditor").getDomRef(),placeholder:n.getResourceBundle().getText("0386"),setup:function e(i){i.on("init",function(){i.setContent(n.getModel("emailTemplate").getProperty("/content"));t()})}})}else{t()}n._oEmailTemplateEditor.render()})}}});