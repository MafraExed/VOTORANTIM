"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}
/*!
 * SiGC - GestiÃ³n de Compras
 * (c) Copyright 2022 Innova Internacional S.A.S.
 */sap.ui.define(["com/innova/sigc/model/item/FormItem","com/innova/sigc/model/item/OptionType","com/innova/sigc/model/variant/ItemVariant","com/innova/sigc/utils/addPatternToText","sap/m/Token","sap/ui/core/ValueState"],function(e,t,r,n,a,o){var i=function e(t,r){var n=t.length;if(n>0){for(var a=0;a<n;a+=1){var o=t[a];if(o.getKey()===r){return true}}}return false};var u=function e(t){return function(e){var r=e.text;if(t!=="X"){r=r.toUpperCase()}return new a({key:r,text:r})}};var c=function e(t){var r=t.text;if(/^\w+([\\.-]?\w+)*@\w+([\\.-]?\w+)*(\.\w{2,3})+$/.test(r)){return new a({key:r,text:r})}return undefined};var f=function e(t){var r=t.getSource();var n=r.getBindingContext();var a=n.getPath();var o=n.getModel();var i=n.getProperty("E_MAILS");var u=t.getParameter("type");var c=t.getParameter("addedTokens");var f=t.getParameter("removedTokens");if(u==="added"){c.forEach(function(e){i.push({EMAIL:e.getKey()})})}else if(u==="removed"){f.forEach(function(e){i=i.filter(function(t){return t.EMAIL!==e.getKey()})})}o.setProperty("".concat(a,"/E_MAILS"),i)};var l=function e(t){var r=t.field;return r.getTokens().length>0};return{isMultiInputValid:l,addTokensToMultiInput:function e(t,r,n){t.forEach(function(e){var t=e[r]||e.getObject()[r];t=t.replace(/\*/g,"");if(!i(n.getTokens(),t)){n.addToken(new a({key:t,text:t}))}})},addValidatorAllMultiInputs:function e(t){var r=t.fields;r.filter(function(e){return e.isA("sap.m.MultiInput")}).forEach(function(e){e.removeAllValidators();e.addValidator(u(e.data("lowercase")))})},addValidatorEmailMultiInputs:function e(t){var r=t.fields;r.filter(function(e){return e.isA("sap.m.MultiInput")}).forEach(function(e){e.removeAllValidators();e.addValidator(c);e.attachTokenUpdate(f)})},getMultiInputData:function e(t){var r=t.field;var n=[];var a=r.getTokens();if(l({field:r})){r.setValueState(o.None);n=a.map(function(e){return e.getKey()})}return _objectSpread({},n.length&&_defineProperty({},r.getName(),n))},setMultiInputData:function e(t){var r=t.field,n=t.data;var o=n[r.getName()];r.setTokens(o.map(function(e){return new a({key:e.key,text:e.text})}))},setMultiInputDataVendor:function e(t){var r=t.field,n=t.data;r.setTokens(n.map(function(e){return new a({key:e.id,text:e.description})}))},cleanMultiInput:function e(t){var r=t.field;r.removeAllTokens();r.fireTokenUpdate({type:"removed"})}}});