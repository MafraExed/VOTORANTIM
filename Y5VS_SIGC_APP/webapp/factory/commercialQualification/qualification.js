"use strict";
/*!
 * SiGC - GestiÃ³n de Compras
 * (c) Copyright 2022 Innova Internacional S.A.S.
 */sap.ui.define(["com/innova/sigc/formatter/date","com/innova/sigc/formatter/yesOrNoText","com/innova/sigc/model/process/EntProvEvaluationCriteria","com/innova/sigc/model/process/processStatus/useProcessStatus","com/innova/sigc/model/process/ValoracionEvaluationCriteria","com/innova/sigc/model/offer/offerStatus/useOfferStatus","com/innova/sigc/utils/isEmpty","sap/m/ColumnListItem","sap/m/ObjectIdentifier","sap/m/Input","sap/m/Text","sap/m/VBox","sap/ui/core/ValueState"],function(e,t,o,a,r,n,i,s,c,u,l,v,d){var m={createItems:function e(t,o){var a=this;return new s(t,{selected:{path:"selected"}}).bindAggregation("cells",{path:"/columns",factory:function e(t,r){var n=r.getProperty("template");var i="_buildTemplate".concat(n);if(m["".concat(i)]){return m["".concat(i)].call(a,{id:t,context:o.getObject(),options:r.getObject()})}var s=o.getProperty("".concat(r.getProperty("name")));return new l(t,{text:a.getResourceBundle().getText(s)||""})}})},_buildTemplateMatnr:function e(t){var o=t.id,a=t.context;return new c(o,{text:"".concat(a.matnr||""),title:"".concat(a.maktx)})},_buildTemplateCustom:function e(t){var o,a,r,s,c,l,p;var f=t.id,g=t.context,b=t.options;var P=g.entradaProveedor,h=g.valoracion,y=g.isPrice;var w=(o=(a=g.status)===null||a===void 0?void 0:a.get(b.vendorId))!==null&&o!==void 0?o:{};var x=m._canQualify({entradaProveedor:P,offerStatus:w.status,processStatus:b.processStatus,valoracion:h,vendorValue:g[b.name]});var S=(r=w.statusType)===null||r===void 0?void 0:r.charAt(0).toUpperCase();var I=n.getStatusMetadata(w.status,{type:S});var T=this._i18n.getText("".concat(I.text));var C=(s=(c=g.commentsByPosition)===null||c===void 0?void 0:c.get(b.vendorId))!==null&&s!==void 0?s:{};var _=(l=g.qualifications)===null||l===void 0?void 0:(p=l.get(b.vendorId))===null||p===void 0?void 0:p.value;return new v(f,{items:[new sap.m.HBox({items:[new sap.ui.core.Icon({src:I.icon,color:I.color,tooltip:T,visible:!!w}),new sap.m.ObjectStatus({icon:"sap-icon://comment",active:true,inverted:false,tooltip:"{i18n>0111}",visible:!i(C.comments),state:"Indication05",press:this.onShowPositionComments.bind(this,{commentsByPosition:C})})]}),m._getControlToDisplay.call(this,{entradaProveedor:P,isPrice:y,value:g[b.name]}),new u({value:_,description:"%",enabled:x,valueState:x&&i(_)?d.Error:d.None,placeholder:b.placeholder||this.getResourceBundle().getText("0132"),maxLength:3,change:this.onQualificationInputChange.bind(this,{options:b})})]})},_canQualify:function e(t){var s=t.entradaProveedor,c=t.offerStatus,u=t.processStatus,l=t.valoracion,v=t.vendorValue;var d=n.isPositionRejected(c);if(d){return false}var m=a.inNewRound(u)||a.inAdjudication(u)||a.inPurchaseOrder(u);if(m){return false}var p=l!==r.X.key;if(p){return false}return s===o.A.key||s!==o.A.key&&!i(v)},_getControlToDisplay:function e(t){var o=t.entradaProveedor,a=t.isPrice,r=t.value;if(a&&r){return new sap.m.ObjectNumber({number:new Intl.NumberFormat(this.getModel("main").getProperty("/currentLanguage")).format(r.bbwert),unit:r.waers,visible:!i(r.bbwert)})}return new l({text:m._formatValue({entradaProveedor:o,value:r})})},_formatValue:function o(a){var r=a.entradaProveedor,n=a.value,i=n===void 0?"":n;var s={D:e,C:t};return s[r]&&s[r](i)||i}};return m});