sap.ui.define(["Y5GL_EC_CSC/Y5GL_EC_CSC/controller/BaseController","sap/ui/Device","sap/m/Dialog","sap/m/Button"],function(e,t,r,s){"use strict";return e.extend("Y5GL_EC_CSC.Y5GL_EC_CSC.controller.DEPENDENTES",{onInit:function(){this.getRouter().getRoute("DEPENDENTES").attachPatternMatched(this.onRefreshList,this)},onRefreshList:function(){var e=this.getView().byId("list");var t=e.getBinding("items");t.refresh(true)},onSelectionChange:function(e){var t=e.getSource(),r=e.getParameter("selected");if(!(t.getMode()==="MultiSelect"&&!r)){this._showDetail(e.getParameter("listItem")||e.getSource())}},_showDetail:function(e){var r=!t.system.phone;var s="DepententeDetail";var a=e.getBindingContext().getProperty("Pernr");var o=e.getBindingContext().getProperty("Subty");var i="V";var n=e.getBindingContext().getProperty("Objps");if(n===""){n="0"}var c=e.getBindingContext().getProperty("Favor");this.getRouter().navTo(s,{Pernr:a,Subty:o,Objps:n,Tipo:i,Favor:c},r)},addDependentes:function(e){var t="0";var r="A";var s="-";var a="-";var o="-";var i="DependentesAdd";this.getRouter().navTo(i,{Pernr:t,Subty:a,Objps:s,Tipo:r,Favor:o})},onSave:function(){var e=this.getOwnerComponent();var t=e.oListSelector._oList;var a=t.getBinding("items");var o=this.getView().getModel();var i=this.getView().byId("IdPernr").getValue();var n=this.getView().byId("IdParentesco").getSelectedKey();var c=this.getView().byId("IdObjps").getValue();c="-";var d="/ZET_GLRH_LIST_DEPENDENTESSet(Pernr='"+i+"',Subty='"+n+"',Objps='"+c+"',Tipo='S')";var u={};u.Parentesco=this.getView().byId("IdParentesco").getSelectedKey();if(u.Parentesco===""){this.getView().byId("IdParentesco").setValueState("Error");sap.m.MessageBox.error("Selecione o Grau de Parentesco.");return}else{this.getView().byId("IdParentesco").setValueState("Success")}u.Favor=this.getView().byId("IdFavor").getValue();if(u.Favor===""){this.getView().byId("IdFavor").setValueState("Error");sap.m.MessageBox.error("Preencher o Nome.");return}else{this.getView().byId("IdFavor").setValueState("Success")}u.Fanam=this.getView().byId("IdFanam").getValue();if(u.Fanam===""){this.getView().byId("IdFanam").setValueState("Error");sap.m.MessageBox.error("Preencher o sobrenome.");return}else{this.getView().byId("IdFanam").setValueState("Success")}u.Fgbdt=this.getView().byId("IdFgbdt").getValue();if(u.Fgbdt===""){this.getView().byId("IdFgbdt").setValueState("Error");sap.m.MessageBox.error("Selecione data de nascimento.");return}else{this.getView().byId("IdFgbdt").setValueState("Success")}u.Sexo=this.getView().byId("IdSexo").getSelectedKey();if(u.Sexo===" "){this.getView().byId("IdSexo").setValueState("Error");sap.m.MessageBox.error("Selecione o sexo.");return}else{this.getView().byId("IdSexo").setValueState("Success")}u.Zzestciv=this.getView().byId("IdZzestciv").getSelectedKey();if(u.Zzestciv===" "){this.getView().byId("IdZzestciv").setValueState("Error");sap.m.MessageBox.error("Selecione o Estado Civil.");return}else{this.getView().byId("IdZzestciv").setValueState("Success")}var g=" ";var l=g;if(l===""){sap.m.MessageBox.error("Anexo é obrigatório");return}var v=new r({title:"Confirmação",type:"Message",content:new Text({text:"Confirma o envio do novo dependente para aprovação?"}),beginButton:new s({text:"Sim",press:function(){o.update(d,u,{success:function(e,t){sap.m.MessageBox.success("Dependente enviado para aprovação com sucesso. Favor aguardar aprovação CSC.",{actions:["OK",sap.m.MessageBox.Action.CLOSE],onClose:function(e){v.close()}})},error:function(e){sap.m.MessageBox.error("Erro ao chamar o serviço")}});v.close()}}),endButton:new s({text:"Não",press:function(){v.close()}}),afterClose:function(){v.destroy();a.refresh(true);this.getModel("appView").setProperty("/layout","MidColumnFullScreen");this.getRouter().navTo("master")}});v.open();this.getRouter().navTo("master")},formatterStateStatus:function(e){switch(e){case"A":return"Success";break;case"X":return"Error";break}},formatterText:function(e){switch(e){case"A":return"Ativo";break;case"X":return"Bloqueado";break}},onBackMaster:function(){this.getRouter().navTo("master")}})});