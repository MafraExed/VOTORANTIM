"use strict";function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,n)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach(function(t){_defineProperty(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function _defineProperty(e,t,s){if(t in e){Object.defineProperty(e,t,{value:s,enumerable:true,configurable:true,writable:true})}else{e[t]=s}return e}sap.ui.define(["../BaseController","./components/DocumentType","./components/Priority","./components/Parameter","com/innova/formatter/getVisibleRowCount","com/innova/lib/searchHelp/searchHelp","com/innova/model/constant","com/innova/service/petitions","sap/m/Button","sap/m/ButtonType","sap/m/Dialog","sap/m/DialogType","sap/m/MessageBox","sap/m/Text","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],function(e,t,s,n,o,i,r,a,c,l,d,g,u,p,h,y){return e.extend("com.innova.controller.settings.Settings",_objectSpread(_objectSpread(_objectSpread(_objectSpread({},t),s),n),{},{formatter:{getVisibleRowCount:o},searchHelp:i,onInit:function e(){var t=new y(sap.ui.require.toUrl("com/innova/model/settings/ToolbarContent.json"));this.getView().setModel(t,"Settings");this._oRouter=this.getRouter();this._oRouter.getRoute("settings").attachMatched(this._onRouteMatched,this)},_onRouteMatched:function e(){this.getView().getModel("Settings").setProperty("/createpriority",{});this.getView().getModel("Settings").setProperty("/createdocumenttype",{BSART:"",WERKS_F:"",WERKS_T:""});this.sSelectedTabKey="sBuyersId";this.getView().byId("pageContainer").setInitialPage(this.getView().byId("sBuyersId"));this.getDocumentTypes()},onItemSelect:function e(t){this.getView().getModel("Settings").setProperty("/selectedTableRow",[]);var s=t.getParameter("item");this.byId("pageContainer").to(this.getView().createId(s.getKey()));this.sSelectedTabKey=s.getKey();if(s.getKey()==="sCategoriesId"){this.getCategories()}else if(s.getKey()==="sPrioritiesId"){this.getPriorities()}else if(s.getKey()==="sParametersId"){this.getParameters()}else{this.getDocumentTypes()}},_handleResponseData:function e(t){var s=t.data;this.getView().getModel("Settings").setProperty("/processtexttypes",s);this.getView().getModel("Settings").refresh(true)},handleSaveorUpdate:function e(t,s,n){if(s){return a.update(n,t)}return a.post(n,t)},handleGenericRecordDelete:function e(t){var s=this;var n=this;var o="";var i=null;if(n.sSelectedTabKey==="sBuyersId"){o=r.GET_CONF_DOCS;i={IT_DOCS:[t]}}else if(n.sSelectedTabKey==="sPrioritiesId"){o=r.GET_CONF_PRIORITY;i={IT_PRIOR:[t]}}else if(n.sSelectedTabKey==="sParametersId"){o=r.PARAMETERS_SETTINGS;i={IT_PARAMS:[{MANDT:"",PARNAME:t.PARNAME,PARLINE:t.PARLINE,PARVALUE:t.PARVALUE}],IV_OPERATION:"4"}}a.post(o,i).then(function(){if(n.sSelectedTabKey==="sBuyersId"){n.getDocumentTypes()}else if(n.sSelectedTabKey==="sPrioritiesId"){n.getPriorities()}else if(n.sSelectedTabKey==="sParametersId"){s.getParameters()}u.success(s.getResourceBundle().getText("Settings.0010"))}).then(this.clearSelectedIndex.bind(this)).catch(this.errorHandler.bind(this))},onNavtoHomePress:function e(){this._oRouter.navTo("home",{},{},true)},onShowValueHelpPress:function e(){var t=this.getView();if(!this._pDialog){this._pDialog=h.load({id:t.getId(),name:"com.innova.view.settings.fragment.GlobalSearchHelp",controller:this}).then(function(e){e.setModel(t.getModel());return e})}this._pDialog.then(function(e){e.open()})},clearSelectedIndex:function e(){this.byId("prioritiesTable").setSelectedIndex(-1);this.byId("parametersTable").setSelectedIndex(-1);this.byId("buyerTable").setSelectedIndex(-1)},onTableRowSelect:function e(t){var s=[];if(t.getSource().getSelectedIndex()!==-1){var n=t.getParameter("rowContext").getObject();s.push(n)}this.getView().getModel("Settings").setProperty("/selectedTableRow",s)},_openDeleteRecordDialog:function e(t,s,n,o){var i=this;var r=new d({type:g.Message,title:this.getResourceBundle().getText("Settings.0030"),content:new p({text:this.getResourceBundle().getText("Settings.0008")}),beginButton:new c({type:l.Emphasized,text:this.getResourceBundle().getText("Settings.0009"),press:function e(){if(!n){i.handleDeleteRecord(t,s,o)}else{i.handleGenericRecordDelete(o)}r.close()}}),endButton:new c({type:l.Reject,text:this.getResourceBundle().getText("Settings.0007")})});this.getView().addDependent(r);r.attachAfterClose(r.destroy.bind(r));r.getEndButton().attachPress(r.close.bind(r));r.addStyleClass(this.getOwnerComponent().getContentDensityClass());r.open()}}))});