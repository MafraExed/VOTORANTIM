"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}sap.ui.define(["com/innova/formatter/columnTitleProcess","com/innova/formatter/notificationColor","com/innova/formatter/notificationIcon","com/innova/lib/notification/notification","com/innova/lib/attachment/attachment","com/innova/model/formatter","sap/m/DatePicker","sap/m/FlexBox","sap/m/HBox","sap/m/Label","sap/m/ObjectIdentifier","sap/m/ProgressIndicator","sap/m/Switch","sap/m/Text","sap/m/Button","sap/m/TextArea","sap/ui/core/CustomData","sap/ui/core/Icon","sap/ui/table/Column"],function(e,t,r,n,o,i,a,s,c,p,l,u,m,d,f,b,T,y,g){var v='{= %{process>BANFN} !== "" || %{process>EBELN} === "" }';var P='{= %{process>EBELN} !== "" }';var w={tableProcess:function t(r,n){w.controller=this;var o=n.getObject();var i=o.FIELDNAME;var a=o.INTTYPE;var s="process>".concat(i);var c=new d({text:"{".concat(s,"}")});var l="_buildTemplateType".concat(i);if(w["".concat(l)]){c=w["".concat(l)]({context:n,path:s})}else{c=w._buildDefaultTemplate({context:n.getObject(),path:s})}var u=i;if(i==="SolPed"){u="BANFN"}else if(i==="ZMATNR"){u="PR_MATNR"}else if(i==="ZPEDIDO"){u="EBELN"}return new g({id:r,label:new p({text:{parts:["process>REPTEXT","process>SCRTEXT_L","process>SP_GROUP"],formatter:e},tooltip:{parts:["process>REPTEXT","process>SCRTEXT_L","process>SP_GROUP"],formatter:e},wrapping:true,wrappingType:"Hyphenated"}),autoResizable:true,filterOperator:"Contains",filterProperty:"".concat(u),hAlign:a==="N"?"End":"Left",name:"".concat(u),showFilterMenuEntry:true,showSortMenuEntry:true,sortProperty:"".concat(u),template:c,visible:"{= %{process>TECH} !== 'X' && %{process>NO_OUT} !== 'X' }",width:"{= parseInt(%{process>OUTPUTLEN}) > 0 ? parseInt(%{process>OUTPUTLEN}) + 'px' : '130px' }"})},_buildDefaultTemplate:function e(t){var r=t.path,n=t.context;var o=n.INTTYPE;return new d({text:{parts:["".concat(r)],formatter:function e(t){if(o==="D"){if(t==="0000-00-00"){return null}if(t!==null){return i.formatDateSAP(t===null||t===void 0?void 0:t.split("T")[0],"DD/MM/yyyy")}return t}if(o==="P"&&t!==null){return i.floatNumberFormat(t)}return t}}})},_buildTemplateTypelongText:function e(){return new f({icon:"sap-icon://message-popup",ariaHasPopup:"Dialog",visible:"{= !!%{process>longText} }",press:w.onShowTextDialog.bind(w.controller,{prop:"longText",title:"K366"})})},_buildTemplateTypelongTextComp:function e(){return new f({icon:"sap-icon://message-popup",ariaHasPopup:"Dialog",visible:"{= !!%{process>longTextComp}}",press:w.onShowTextDialog.bind(w.controller,{prop:"longTextComp",title:"K216"})})},_buildTemplateTypeAttachments:function e(){return new f({tooltip:"{main>textPool/K217}",icon:"sap-icon://attachment",press:[o.showAttachment,this],visible:"{= ${process>INF_ADJUNTOS}.length > 0 ? true : false}"})},_buildTemplateTypeAttachmentsSolPed:function e(){return new f({tooltip:"{main>textPool/K221}",icon:"sap-icon://attachment",press:[o.showAttachmentSolPed,this],visible:"{= ${process>INF_ADJUNTO_SOLP}.length > 0 ? true : false}"})},_buildTemplateTypeStatus:function e(o){var i=o.context;return new c({alignItems:"Center",items:[new y({visible:'{= typeof %{process>notification} !== "undefined" }',src:{path:"process>notification/type",formatter:r},color:{path:"process>notification/type",formatter:t},press:[n.showNotificationFromContext,this],customData:[new T({key:"context",value:"process"})]}).addStyleClass("sapUiTinyMarginEnd"),new s({direction:"Row",alignItems:"Center",justifyContent:"SpaceAround",wrap:"Wrap",width:"100%"}).bindAggregation("items","process>status",function(e,t){var r=i.getProperty(t.sPath);return new y(e,{backgroundColor:"".concat(r.COLOR),color:"#fff",height:"2.3rem",size:"1.5rem",src:r.ICON,tooltip:r.TOOLTIP,useIconTooltip:false,width:"2.3rem"}).addStyleClass("border-icon")})]})},_buildTemplateTypeSolPed:function e(){return new s({direction:"Row",alignItems:"Start",visible:'{= %{process>BANFN} !== "" }',items:[new l({title:"{process>BANFN}",text:"{process>BNFPO}"})]})},_buildTemplateTypeZPEDIDO:function e(){return new s({direction:"Row",alignItems:"Start",visible:'{= %{process>EBELN} !== "" }',items:[new l({title:"{process>EBELN}",text:"{process>EBELP}"})]})},_buildTemplateTypeZMATNR:function e(){return new s({direction:"Row",alignItems:"Start",items:[new l({title:"{process>MAT_COMB}",text:"{process>TEXT_COMB}"})]})},_buildTemplateTypeZCANTIDADES:function e(t){var r=t.context;return new s({direction:"Column",alignItems:"Center",renderType:"Bare"}).bindAggregation("items","process>quantities",function(e,t){var n=r.getProperty(t.sPath);return new u(e,{percentValue:n.percentValue,state:n.state,displayValue:n.displayValue,showValue:true,displayOnly:true,displayAnimation:true})})},_buildTemplateTypePR_LFDAT:function e(t){return w._buildDatePicker(_objectSpread(_objectSpread({},t),{},{visible:v}))},_buildTemplateTypePR_EBAKZ:function e(t){return w._buildSwitch(_objectSpread(_objectSpread({},t),{},{visible:v}))},_buildTemplateTypePR_LOEKZ:function e(t){var r=t.context,n=t.path;return w._buildSwitch({context:r,path:n,visible:v})},_buildTemplateTypePOI_EINDT:function e(t){return w._buildDatePicker(_objectSpread(_objectSpread({},t),{},{visible:P}))},_buildTemplateTypePOI_ELIKZ:function e(t){return w._buildSwitch(_objectSpread(_objectSpread({},t),{},{visible:P}))},_buildTemplateTypePOI_LOEKZ:function e(t){return w._buildSwitch(_objectSpread(_objectSpread({},t),{},{path:t.path,visible:P}))},onShowTextDialog:function e(t,r){var n=t.prop,o=t.title;var i=r.getSource();var a=i.getBindingContext("process");var s=a.getObject();var c=new sap.m.Dialog({type:sap.m.DialogType.Message,title:this.getMessageTextPool(o),content:new sap.m.Text({text:s[n]}),beginButton:new sap.m.Button({type:sap.m.ButtonType.Emphasized,text:"OK",press:function e(){c.close()}})});c.attachAfterClose(c.destroy.bind(c));c.open()},_buildSwitch:function e(t){var r=t.context,n=t.path,o=t.visible,i=o===void 0?true:o;return new m({customTextOff:"Off",customTextOn:"On",name:r.getProperty("FIELDNAME"),state:"{= %{".concat(n,"}  === 'X' }"),visible:i,change:function e(t){var r=t.getSource();var n=r.getName();var o=r.getBindingContext("process");var i=o.getObject();i["".concat(n)]=r.getState()?"X":"";i["".concat(n,"_FLAG")]="X";i.update=true;o.getModel().updateBindings()}})},_buildDatePicker:function e(t){var r=t.context,n=t.path,o=t.visible;return new a({displayFormat:"yyyy-MM-dd",name:r.getProperty("FIELDNAME"),value:{parts:["".concat(n)],formatter:function e(t){if(t==="0000-00-00"){return null}if(t!==null){return i.formatDateSAP(t===null||t===void 0?void 0:t.split("T")[0],"DD/MM/yyyy")}return t}},valueFormat:"yyyy-MM-dd",visible:o,change:function e(t){var r=t.getParameter("valid");var n=t.getSource();var o=n.getName();var i=n.getBindingContext("process");var a=i.getObject();if(!r){n.setValue(null);n.setValueState("Error");a[o]=null}else{this.setValueState("None");a[o]=n.getValue()}a["".concat(o,"_FLAG")]="X";a.update=true;i.getModel().updateBindings()}})}};return w});