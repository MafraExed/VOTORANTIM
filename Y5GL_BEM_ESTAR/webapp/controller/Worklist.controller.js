sap.ui.define(["Y5GL_BEM_ESTAR/Y5GL_BEM_ESTAR/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","Y5GL_BEM_ESTAR/Y5GL_BEM_ESTAR/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/Dialog","sap/m/Button","sap/m/Text"],function(e,t,a,i,r,o,n,s,l){"use strict";return e.extend("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.controller.Worklist",{formatter:i,onInit:function(){},onPress:function(e){var t=e.getSource();var a="";var i=t.getBindingContext().getProperty("DescricaoApp");var r="";var o;var n=t.getBindingContext().getProperty("Status");var s=t.getBindingContext().getProperty("Chamado");switch(i){case"Benefícios":a="BENEFICIOS_DETAIL";var l=t.getBindingContext().getProperty("Beneficio");r=t.getBindingContext().getProperty("Pernr");this.getRouter().navTo(a,{Beneficio:l,Chamado:s,Pernr:r});break;case"Beneficios":a="BENEFICIOS_DETAIL";var l=t.getBindingContext().getProperty("Beneficio");r=t.getBindingContext().getProperty("Pernr");this.getRouter().navTo(a,{Beneficio:l,Chamado:s,Pernr:r});break;case"Datos personales":a="DADOS_PESSOAIS";r=t.getBindingContext().getProperty("Pernr");this.getRouter().navTo(a,{Pernr:r,Chamado:s});break;case"Dependentes":a="DependenteDetail";r=t.getBindingContext().getProperty("Pernr");o=t.getBindingContext().getProperty("Subty");var g="V";var u=t.getBindingContext().getProperty("Objps");if(u===""){u="00"}var p=t.getBindingContext().getProperty("Favor");var d=t.getBindingContext().getProperty("Icnum");if(d===""){d=" "}this.getRouter().navTo(a,{Pernr:r,Subty:o,Tipo:g,Objps:u,Favor:p,Icnum:d,Chamado:s});break;case"Dependientes":a="DependenteDetail";r=t.getBindingContext().getProperty("Pernr");o=t.getBindingContext().getProperty("Subty");var g="V";var u=t.getBindingContext().getProperty("Objps");if(u===""){u="00"}var p=t.getBindingContext().getProperty("Favor");var d=t.getBindingContext().getProperty("Icnum");if(d===""){d=" "}this.getRouter().navTo(a,{Pernr:r,Subty:o,Tipo:g,Objps:u,Favor:p,Icnum:d,Chamado:s});break;case"Documentos":a="Documentos_Detail";r=t.getBindingContext().getProperty("Pernr");g="V";o=t.getBindingContext().getProperty("Subty");this.getRouter().navTo(a,{Pernr:r,Tipo:g,Subty:o,Chamado:s});break;case"Formación":a="FORMACAO_DETAIL";r=t.getBindingContext().getProperty("Pernr");var v=t.getBindingContext().getProperty("Subty");this.getRouter().navTo(a,{Pernr:r,Slart:v,Chamado:s});break}},onAtualiza:function(){var e=this.getView().byId("smartTable");e.rebindTable("e")},onEnvia:function(e){var t=this.getView().byId("table");var a=t.getSelectedContextPaths();if(a.length<1){sap.m.MessageBox.error("Selecione um chamado para enviar para o operador");return}if(!this._valueHelpDialog1){this._valueHelpDialog1=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.Operador",this);this.getView().addDependent(this._valueHelpDialog1)}this._valueHelpDialog1.open()},onSearch:function(e){var t=e.getParameter("value");var a=e.getSource().getBinding("items");var i=new r("Pernr",o.Contains,t);a.filter([i])},onConfirmOperador:function(e){var t=e.getParameter("selectedItem").getTitle();var a=this.getView().getModel();var i;var r={};var o=this.getView().byId("table");var g=o.getSelectedContextPaths();var u;var p=this.getView().byId("smartTable");var d=new n({title:"Confirmação",type:"Message",content:new l({text:"Confirma o envio das solicitações para o operador selecionado?"}),beginButton:new s({text:"Sim",press:function(){for(var e=0;e<g.length;e++){i=g[e];r.Planejador=t;a.update(i,r,{success:function(e,t){},error:function(e){u=e}})}d.close()}}),endButton:new s({text:"Não",press:function(){d.close()}}),afterClose:function(){d.destroy();if(u){u=u.responseText;var e=JSON.parse(u);var t=e.error.message.value;sap.m.MessageBox.error(t);return}else{sap.m.MessageBox.success("Enviado ao programador com sucesso",{actions:["OK",sap.m.MessageBox.Action.CLOSE],onClose:function(e){p.rebindTable("e")}})}}});d.open()},onHelpChamado:function(e){var t=e.getSource().getValue();this.inputId=e.getSource().getId();if(!this._valueHelpDialog1){this._valueHelpDialog1=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.Chamado",this);this.getView().addDependent(this._valueHelpDialog1)}this._valueHelpDialog1.open(t)},onHelpMatriculas:function(e){var t=e.getSource().getValue();this.inputId=e.getSource().getId();if(!this._valueHelpDialog2){this._valueHelpDialog2=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.Pernr",this);this.getView().addDependent(this._valueHelpDialog2)}this._valueHelpDialog2.open(t)},onHelpProcesso:function(e){var t=e.getSource().getValue();this.inputId=e.getSource().getId();if(!this._valueHelpDialog3){this._valueHelpDialog3=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.Processo",this);this.getView().addDependent(this._valueHelpDialog3)}this._valueHelpDialog3.open(t)},onHelpStatus:function(e){var t=e.getSource().getValue();this.inputId=e.getSource().getId();if(!this._valueHelpDialog4){this._valueHelpDialog4=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.Status",this);this.getView().addDependent(this._valueHelpDialog4)}this._valueHelpDialog4.open(t)},onHelpDtCriacao:function(e){var t=e.getSource().getValue();this.inputId=e.getSource().getId();if(!this._valueHelpDialog5){this._valueHelpDialog5=sap.ui.xmlfragment("Y5GL_BEM_ESTAR.Y5GL_BEM_ESTAR.view.DtCriacao",this);this.getView().addDependent(this._valueHelpDialog5)}this._valueHelpDialog5.open(t)},onSearchChamado:function(e){var t=e.getParameter("value");if(!t){t=" "}t=t.toUpperCase();var a=t;var i=new sap.ui.model.Filter("Chamado",sap.ui.model.FilterOperator.Contains,a);e.getSource().getBinding("items").filter([i])},onSearchMatricula:function(e){var t=e.getParameter("value");if(!t){t=" "}t=t.toUpperCase();var a=t;var i=new sap.ui.model.Filter("Pernr",sap.ui.model.FilterOperator.Contains,a);e.getSource().getBinding("items").filter([i])},onSearchProcesso:function(e){var t=e.getParameter("value");if(!t){t=" "}t=t.toUpperCase();var a=t;var i=new sap.ui.model.Filter("IdApp",sap.ui.model.FilterOperator.Contains,a);e.getSource().getBinding("items").filter([i])},onSearchStatus:function(e){var t=e.getParameter("value");if(!t){t=" "}t=t.toUpperCase();var a=t;var i=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.Contains,a);e.getSource().getBinding("items").filter([i])},ConfirmaChamado:function(e){var t=e.getParameter("selectedItem");this._valueHelpDialog1=null;if(t){var a=this.getView().byId("foo0");a.setValue(t.getTitle())}},ConfirmaMatricula:function(e){var t=e.getParameter("selectedItem");this._valueHelpDialog1=null;if(t){var a=this.getView().byId("foo1");a.setValue(t.getTitle())}},ConfirmaProcesso:function(e){var t=e.getParameter("selectedItem");this._valueHelpDialog1=null;if(t){var a=this.getView().byId("foo2");a.setValue(t.getTitle())}},ConfirmaStatus:function(e){var t=e.getParameter("selectedItem");this._valueHelpDialog1=null;if(t){var a=this.getView().byId("foo3");a.setValue(t.getTitle())}},ChangeChamado:function(e){var t=this.getView().byId("smartTable");t.rebindTable("e")},onbeforeRebindTable:function(e){var t=this.getView().byId("foo0").getValue();var a=this.getView().byId("foo1").getValue();var i=this.getView().byId("foo2").getValue();var r=this.getView().byId("DataCriacao").getValue();e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"Empresa",operator:"EQ",value1:"P"}));if(t!==""){e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"Chamado",operator:"EQ",value1:t}))}if(a!==""){e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"Pernr",operator:"EQ",value1:a}))}if(i!==""){e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"IdApp",operator:"EQ",value1:i}))}e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"Status",operator:"EQ",value1:"BEM_ESTAR"}));if(r!==""){e.getParameter("bindingParams").filters.push(new sap.ui.model.Filter({path:"DataCriacao",operator:"EQ",value1:r}))}},AfterUpdate:function(e){var t=this.getView().byId("table").getModel();t.setSizeLimit("999999")}})});