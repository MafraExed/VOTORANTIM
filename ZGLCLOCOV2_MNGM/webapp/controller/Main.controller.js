sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/FilterOperator","sap/m/GroupHeaderListItem","sap/ui/Device","sap/ui/core/Fragment","../model/formatter"],function(e,t,i,n,a,r,s,o,l){"use strict";return e.extend("votorantim.corp.clocov2planmanagement.controller.Main",{formatter:l,onInit:function(){let e=this.byId("tableTemplatesMain"),i=new t({isFilterBarVisible:false,filterBarLabel:"",delay:0,title:this.getResourceBundle().getText("listTitleCount",[0]),noDataText:this.getResourceBundle().getText("listListNoDataText"),sortBy:"OrderID",groupBy:"None",isTemplate:true}),n=e.getBusyIndicatorDelay();this._oList=e;this.setModel(i,"mainView");e.attachEventOnce("updateFinished",function(){i.setProperty("/delay",n)});this.getRouter().getRoute("main").attachPatternMatched(this._onMasterMatched,this);this.getRouter().attachBypassed(this.onBypassed,this)},onChangeTab:function(e){let t=false;if(e.getParameter("key")==="templates"){t=true}this.getView().getModel("mainView").setProperty("/isTemplate",t)},onPressTemplate:function(e){this.onSelectionChange(e)},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh();return}this.filterTable()},filterTable:function(){let e=[];if(this.getView().getModel("mainView").getProperty("/isTemplate")){if(this.byId("filterProfileTemplateMain").getValue().trim())e.push(new i("Profile",a.EQ,this.byId("filterProfileTemplateMain").getValue()));if(this.byId("filterDescriptionTemplateMain").getValue().trim())e.push(new i("Text",a.Contains,this.byId("filterDescriptionTemplateMain").getValue()));let t=this.byId("tableTemplatesMain").getBinding("items");t.filter(e);t.refresh(true)}else{if(this.byId("filterProfilePlanMain").getValue().trim())e.push(new i("Profile",a.EQ,this.byId("filterProfilePlanMain").getValue()));if(this.byId("filterPeriodPlanMain").getValue().trim())e.push(new i("Periodo",a.EQ,parseInt(this.byId("filterPeriodPlanMain").getValue())));if(this.byId("filterDescriptionPlanMain").getValue().trim())e.push(new i("Descricao",a.EQ,this.byId("filterDescriptionPlanMain").getValue()));let t=this.byId("tablePlans").getBinding("items");t.filter(e);t.refresh(true)}},onRefresh:function(){this._oList.getBinding("items").refresh()},onSelectionChange:function(e){this._showDetail(e)},onBypassed:function(){this._oList.removeSelections(true)},onNavBack:function(){history.go(-1)},_onMasterMatched:function(){this.getModel("appView").setProperty("/layout","OneColumn")},_showDetail:function(e){this.getView().getParent().getParent().removeAllBeginColumnPages();var t=!s.system.phone;this.getRouter().navTo("detail",{profile:e.getSource().getSelectedContexts()[0].getProperty("Profile"),instance:e.getSource().getSelectedContexts()[0].getProperty("Instance")},t)}})});